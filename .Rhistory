+ park_km + green_zone_km + industrial_km + railroad_station_walk_km + ID_railroad_station_walk
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ park_km + industrial_km + railroad_station_walk_km + ID_railroad_station_walk
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ log(park_km) + industrial_km + railroad_station_walk_km + ID_railroad_station_walk
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + railroad_station_walk_km + ID_railroad_station_walk
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + big_road1_km + big_road2_km
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_min_walk + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school
+ healthcare_centers_raion + university_top_20_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school
+ healthcare_centers_raion + university_top_20_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school
+ healthcare_centers_raion + university_top_20_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:floor, data = df)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school
+ healthcare_centers_raion + university_top_20_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_km_walk + school_km
+ log(park_km) + log(industrial_km) + log(railroad_station_walk_km) + log(ID_railroad_station_walk)
+ log(railroad_station_avto_km) + log(public_transport_station_km)
+ log(kremlin_km) + log(big_road1_km) + log(big_road2_km)
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ park_km + green_zone_km + industrial_km + railroad_station_walk_km + ID_railroad_station_walk
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + workplaces_km + full_sq:life_sq + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
anova$model.Allvar
anova(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ park_km + green_zone_km + industrial_km + railroad_station_walk_km + ID_railroad_station_walk
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school + hospital_beds_raion
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ park_km + green_zone_km + industrial_km
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ park_km + green_zone_km + industrial_km
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ industrial_km
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ public_healthcare_km + full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk + metro_km_walk + school_km
+ industrial_km
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk +school_km
+ industrial_km
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km + big_road2_km
+ full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_preschool + preschool_quota + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk +school_km
+ industrial_km
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km
+ full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
+ raion_popul + green_zone_part + indust_part + children_school
+ healthcare_centers_raion + university_top_20_raion + shopping_centers_raion + office_raion + railroad_terminal_raion
+ big_market_raion + full_all + build_count_block + build_count_wood
+ build_count_frame + build_count_brick + metro_min_avto + metro_km_avto + metro_min_walk +school_km
+ industrial_km
+ railroad_station_avto_km + public_transport_station_km
+ kremlin_km + big_road1_km
+ full_sq:num_room + full_sq:kitch_sq + full_sq:floor, data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor , data = df)
summary(model.Allvar)
model.Allvar <- lm(price_doc ~ id + full_sq +	floor + life_sq + max_floor + num_room + kitch_sq + product_type
, data = df)
summary(model.Allvar)
fwd.suggested.lmModel <- lm(price_doc ~ full_sq + life_sq + floor + max_floor + kitch_sq + product_type + children_preschool +
preschool_quota + children_school + university_top_20_raion + metro_min_walk + industrial_km + railroad_station_walk_km +
kremlin_km + big_road1_km + big_road2_km + public_healthcare_km, data = df)
model.Forward2 <- stepAIC(fwd.suggested.lmModel, direction = "forward", trace = F, scope = formula(model.forward.Start))
summary(model.Forward2)
fwd.suggested.lmModel <- lm(price_doc ~ full_sq + life_sq + floor + max_floor + kitch_sq + product_type + children_preschool +
preschool_quota + children_school + university_top_20_raion + metro_min_walk + industrial_km + railroad_station_walk_km +
kremlin_km + big_road1_km + big_road2_km + public_healthcare_km + material + X0_17_all + fitness_km + num_room + id + railroad_km +
big_market_km + university_km + green_zone_km + railroad_station_avto_km + basketball_km + swim_pool_km + ice_rink_km, data = df)
summary(fwd.suggested.lmModel)
fwd.suggested.lmModel <- lm(log(price_doc) ~ full_sq + life_sq + floor + max_floor + kitch_sq + product_type + children_preschool +
preschool_quota + children_school + university_top_20_raion + metro_min_walk + industrial_km + railroad_station_walk_km +
kremlin_km + big_road1_km + big_road2_km + public_healthcare_km + material + X0_17_all + fitness_km + num_room + id + railroad_km +
big_market_km + university_km + green_zone_km + railroad_station_avto_km + basketball_km + swim_pool_km + ice_rink_km, data = df)
summary(fwd.suggested.lmModel)
df <- read.csv("c:/users/pablo/dekstop/modelingData.csv",  header=T, sep=",", strip.white=T, stringsAsFactors = F)
df <- read.csv("c:/users/pablo/dekstop/kg6372/modelingData.csv",  header=T, sep=",", strip.white=T, stringsAsFactors = F)
df <- read.csv("c:/users/pablo/desktop/kg6372/modelingData.csv",  header=T, sep=",", strip.white=T, stringsAsFactors = F)
df$floor <- df$floor %>% replace_na(0)
##########
df$product_type <- as.factor(df$product_type)
########## Hospital bed raion
df[which(!is.na(df$hospital_beds_raion)),] <- 1
df$hospital_beds_raion <- df$hospital_beds_raion %>% replace_na(0)
##########
########## material
df <- df %>% group_by(product_type) %>% mutate(material = na.mean(material))
df$material <- round(df$material)
df$material <- dplyr::recode(df$material, `1` = "Material_1",`2` = "Material_2",`3` = "Material_3"
,`4` = "Material_4",`5` = "Material_5",`6` = "Material_6") %>% as.factor()
##########
########## max floor
df2.maxfl <- df[which(!is.na(df$max_floor)),]
maxfl.Mean <- data.frame(df2.maxfl$max_floor/df2.maxfl$full_sq)
colnames(maxfl.Mean) <- "percentofFloor"
maxflMultiplier <- mean(head(maxfl.Mean$percentofFloor,7000))
df[which(is.na(df$max_floor)),6] <- df[which(is.na(df$max_floor)),3]*maxflMultiplier
##########
########## life sq
df2.lifesq <- df[which(!is.na(df$life_sq)),]
life.Mean <- data.frame(df2.lifesq$life_sq/df2.lifesq$full_sq)
colnames(life.Mean) <- "percentofFull"
lifesqMultiplier <- mean(head(life.Mean$percentofFull,11000))
df[which(is.na(df$life_sq)),4] <- df[which(is.na(df$life_sq)),3]*lifesqMultiplier
dishonestLivingSpace <- (df$life_sq - df$full_sq)
df <- data.frame(dishonestLivingSpace, df)
df <- df[which(df$dishonestLivingSpace < 0),] #living space shouldn't be greater than the full sq, considering lofts that have shared external bathrooms
df <- subset(df, select = -c(dishonestLivingSpace)) # remove the counter variable dishonestLivingSpace
##########
########## kithcen sq
df2.kitchsq <- df[which(!is.na(df$kitch_sq)),]
kitch.Mean <- data.frame(df2.kitchsq$kitch_sq/df2.kitchsq$full_sq)
colnames(kitch.Mean) <- "percentofFull"
kitchsqMultiplier <- mean(head(kitch.Mean$percentofFull,7000))
df[which(is.na(df$kitch_sq)),10] <- df[which(is.na(df$kitch_sq)),3]*kitchsqMultiplier
dishonestKitchens <- (df$kitch_sq - df$full_sq)
df <- data.frame(dishonestKitchens, df)
df <- df[which(df$dishonestKitchens < -2),] #kitchen space shouldn't be greater than more than 2 meters less than the full sq
df <- subset(df, select = -c(dishonestKitchens)) # remove the counter variable dishonestKitchens
df$kitch_sq <- sqrt(df$kitch_sq^1/16+1)
##########
########## num room
df2.numRm <- df[which(!is.na(df$num_room)),]
numRm.Mean <- data.frame(df2.numRm$num_room/df2.numRm$full_sq)
colnames(numRm.Mean) <- "percentofFullrm"
numRmMultiplier <- mean(head(numRm.Mean$percentofFullrm,7000))
df[which(is.na(df$num_room)),9] <- df[which(is.na(df$num_room)),3]*numRmMultiplier
df <- df[which(df$num_room < 30),]
##########
########## preschool quota
df.preK.no.NA <- df[which(!is.na(df$preschool_quota)),]
preK.Mean <- data.frame(df.preK.no.NA$preschool_quota/df.preK.no.NA$X0_6_all)
colnames(preK.Mean) <- "percentofFloor"
preKquotaMultiplier <- mean(head(preK.Mean$percentofFloor,5000))
df[which(is.na(df$preschool_quota)),16] <- df[which(is.na(df$preschool_quota)),26]*preKquotaMultiplier
df$preschool_quota <- sqrt(df$preschool_quota)
##########
########## build year
df <- subset(df, select = -c(build_year))
##########
########## office raion
df$office_raion <- sqrt(df$office_raion^1/10)
##########
########## big market raion
df$big_market_raion <- dplyr::recode(df$big_market_raion,  "no" = 0, "yes"= 1)
##########
########## railroad terminal raion
df$railroad_terminal_raion <- dplyr::recode(df$railroad_terminal_raion,  "no" = 0, "yes"= 1)
##########
##########
df <- df %>% mutate(railroad_station_walk_min = if_else(is.na(railroad_station_walk_min),0,railroad_station_walk_min))
##########
##########
df <- df %>% mutate(ID_railroad_station_walk = if_else(is.na(ID_railroad_station_walk),0,ID_railroad_station_walk))
##########
##########
df <- df[which(!is.na(df$build_count_before_1920)),] #one fell swoop to take out all NA 'build_count_{year range}' rows
##########
############################## conversion to numeric and factor only for modeling consistency #############################
df <- df %>% mutate_if(is.integer, as.numeric) %>% mutate_if(is.character, as.factor) %>% data.frame()
fwd.suggested.lmModel <- lm(price_doc ~ full_sq + life_sq + floor + max_floor + kitch_sq + product_type + children_preschool +
preschool_quota + children_school + university_top_20_raion + metro_min_walk + industrial_km + railroad_station_walk_km +
kremlin_km + big_road1_km + big_road2_km + public_healthcare_km, data = df)
model.Forward2 <- stepAIC(fwd.suggested.lmModel, direction = "forward", trace = F, scope = formula(model.forward.Start))
summary(model.Forward2)
stepAIC
fwd.suggested.lmModel <- lm(price_doc ~ full_sq + life_sq + floor + max_floor + kitch_sq + product_type + children_preschool +
preschool_quota + children_school + university_top_20_raion + metro_min_walk + industrial_km + railroad_station_walk_km +
kremlin_km + big_road1_km + big_road2_km + public_healthcare_km + material + X0_17_all + fitness_km + num_room + id + railroad_km +
big_market_km + university_km + green_zone_km + railroad_station_avto_km, data = df)
summary(fwd.suggested.lmModel)
library(pacman)
p_load(#lmtest
dplyr
,Hmisc
,skimr
,tidyr
,na.tools
,tidyverse
#       ,olsrr
,caret
#      ,multcomp
,ggthemes
,MASS# for OLS
#     ,regclass# for VIF
)
df <- read.csv("./modelingData.csv",  header=T, sep=",", strip.white=T, stringsAsFactors = F)
hist(df$floor)
hist(log(df$floor+1)
hist(log(df$floor+1))
hist(log(df$floor+1))
df$floor <- df$floor %>% replace_na(0)
df$floor <- log(df$floor+1)
##########
df$product_type <- as.factor(df$product_type)
########## Hospital bed raion
df[which(!is.na(df$hospital_beds_raion)),] <- 1
df$hospital_beds_raion <- df$hospital_beds_raion %>% replace_na(0)
##########
########## material
df <- df %>% group_by(product_type) %>% mutate(material = na.mean(material))
df$material <- round(df$material)
df$material <- dplyr::recode(df$material, `1` = "Material_1",`2` = "Material_2",`3` = "Material_3"
,`4` = "Material_4",`5` = "Material_5",`6` = "Material_6") %>% as.factor()
##########
########## max floor
df2.maxfl <- df[which(!is.na(df$max_floor)),]
maxfl.Mean <- data.frame(df2.maxfl$max_floor/df2.maxfl$full_sq)
colnames(maxfl.Mean) <- "percentofFloor"
maxflMultiplier <- mean(head(maxfl.Mean$percentofFloor,7000))
df[which(is.na(df$max_floor)),6] <- df[which(is.na(df$max_floor)),3]*maxflMultiplier
##########
########## life sq
df2.lifesq <- df[which(!is.na(df$life_sq)),]
life.Mean <- data.frame(df2.lifesq$life_sq/df2.lifesq$full_sq)
colnames(life.Mean) <- "percentofFull"
lifesqMultiplier <- mean(head(life.Mean$percentofFull,11000))
df[which(is.na(df$life_sq)),4] <- df[which(is.na(df$life_sq)),3]*lifesqMultiplier
dishonestLivingSpace <- (df$life_sq - df$full_sq)
df <- data.frame(dishonestLivingSpace, df)
df <- df[which(df$dishonestLivingSpace < 0),] #living space shouldn't be greater than the full sq, considering lofts that have shared external bathrooms
df <- subset(df, select = -c(dishonestLivingSpace)) # remove the counter variable dishonestLivingSpace
##########
########## kithcen sq
df2.kitchsq <- df[which(!is.na(df$kitch_sq)),]
kitch.Mean <- data.frame(df2.kitchsq$kitch_sq/df2.kitchsq$full_sq)
colnames(kitch.Mean) <- "percentofFull"
kitchsqMultiplier <- mean(head(kitch.Mean$percentofFull,7000))
df[which(is.na(df$kitch_sq)),10] <- df[which(is.na(df$kitch_sq)),3]*kitchsqMultiplier
dishonestKitchens <- (df$kitch_sq - df$full_sq)
df <- data.frame(dishonestKitchens, df)
df <- df[which(df$dishonestKitchens < -2),] #kitchen space shouldn't be greater than more than 2 meters less than the full sq
df <- subset(df, select = -c(dishonestKitchens)) # remove the counter variable dishonestKitchens
df$kitch_sq <- sqrt(df$kitch_sq^1/16+1)
##########
########## num room
df2.numRm <- df[which(!is.na(df$num_room)),]
numRm.Mean <- data.frame(df2.numRm$num_room/df2.numRm$full_sq)
colnames(numRm.Mean) <- "percentofFullrm"
numRmMultiplier <- mean(head(numRm.Mean$percentofFullrm,7000))
df[which(is.na(df$num_room)),9] <- df[which(is.na(df$num_room)),3]*numRmMultiplier
df <- df[which(df$num_room < 30),]
##########
########## preschool quota
df.preK.no.NA <- df[which(!is.na(df$preschool_quota)),]
preK.Mean <- data.frame(df.preK.no.NA$preschool_quota/df.preK.no.NA$X0_6_all)
colnames(preK.Mean) <- "percentofFloor"
preKquotaMultiplier <- mean(head(preK.Mean$percentofFloor,5000))
df[which(is.na(df$preschool_quota)),16] <- df[which(is.na(df$preschool_quota)),26]*preKquotaMultiplier
df$preschool_quota <- sqrt(df$preschool_quota)
##########
########## build year
df <- subset(df, select = -c(build_year))
##########
########## office raion
df$office_raion <- sqrt(df$office_raion^1/10)
##########
########## big market raion
df$big_market_raion <- dplyr::recode(df$big_market_raion,  "no" = 0, "yes"= 1)
##########
########## railroad terminal raion
df$railroad_terminal_raion <- dplyr::recode(df$railroad_terminal_raion,  "no" = 0, "yes"= 1)
##########
##########
df <- df %>% mutate(railroad_station_walk_min = if_else(is.na(railroad_station_walk_min),0,railroad_station_walk_min))
##########
##########
df <- df %>% mutate(ID_railroad_station_walk = if_else(is.na(ID_railroad_station_walk),0,ID_railroad_station_walk))
##########
##########
df <- df[which(!is.na(df$build_count_before_1920)),] #one fell swoop to take out all NA 'build_count_{year range}' rows
##########
############################## conversion to numeric and factor only for modeling consistency #############################
df <- df %>% mutate_if(is.integer, as.numeric) %>% mutate_if(is.character, as.factor) %>% data.frame()
fwd.suggested.lmModel <- lm(price_doc ~ full_sq + life_sq + floor + max_floor + kitch_sq + product_type + children_preschool +
preschool_quota + children_school + university_top_20_raion + metro_min_walk + industrial_km + railroad_station_walk_km +
kremlin_km + big_road1_km + big_road2_km + public_healthcare_km, data = df)
model.Forward2 <- stepAIC(fwd.suggested.lmModel, direction = "forward", trace = F, scope = formula(model.forward.Start))
summary(model.Forward2)
model.Forward2 <- stepAIC(fwd.suggested.lmModel, direction = "forward", trace = F, scope = formula(model.forward.Start))
model.forward.Start <- lm(log(price_doc) ~ ., data = df)
model.end <- lm(log(price_doc) ~ 1, data = df)
model.Forward2 <- stepAIC(fwd.suggested.lmModel, direction = "forward", trace = F, scope = formula(model.forward.Start))
summary(model.Forward2)
summary.lm(model.Forward2)
which(r)
df2.Forward.maxVars <- data.frame(df$price_doc, df$full_sq, df$life_sq, df$floor, df$max_floor, df$kitch_sq, df$product_type, df$children_preschool,
df$preschool_quota, df$children_school, df$university_top_20_raion, df$metro_min_walk, df$industrial_km,
df$railroad_station_walk_km, df$kremlin_km, df$big_road1_km, df$big_road2_km, df$public_healthcare_km)
model.forward.Start2 <- lm(log(df.price_doc) ~ ., data = df2.Forward.maxVars)
model.Forward2 <- stepAIC(fwd.suggested.lmModel, direction = "forward", trace = F, scope = formula(model.forward.Start2))
df2.Forward.maxVars <- data.frame(price_doc, full_sq, life_sq, floor, df$max_floor, df$kitch_sq, df$product_type, df$children_preschool,
df$preschool_quota, df$children_school, df$university_top_20_raion, df$metro_min_walk, df$industrial_km,
df$railroad_station_walk_km, df$kremlin_km, df$big_road1_km, df$big_road2_km, df$public_healthcare_km, data = df)
